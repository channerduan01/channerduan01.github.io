## 三级模式结构
从数据库应用开发人员视角看，数据库系统分为三级分层（整体上都由 DBMS 数据库管理系统来管理）：

- 外模式（也称“用户模式”）：对应 外部视图（通常 “视图” 即外部视图），是用户看的的部分数据的逻辑结构，
- 概念模式（也称“模式”）：对应 概念视图，是数据库中全体数据的逻辑结构和特征描述，一个数据库只有一个概念模式
- 内模式（也称“存储模式”）：对应 内部视图，是存储细节，一个数据库只有一个内模式

两极映像：

- “外模式->概念模式映像” 是具体的数据查询，体现了逻辑独立性，数据与查询解耦
- “概念模式->内模式映像” 是具体的数据存储/索引，体现了物理独立性，数据与物理存储细节解耦


聚簇&非聚簇索引（针对一个“非主键字段”建立索引）：

- 聚簇索引：主文件基于“非主键字段”排序存储，索引文件基于“非主键字段”排序，索引文件没有重复值（每个字段值构成一簇）
- 非聚簇索引：主文件不排序，索引文件基于“非主键字段”排序，索引文件可能会有大量重复值（因为没有聚簇）


## 数据模型
区分为两大类：

- 概念数据模型 即 Entity-Relationship 实体-联系模型，按照用户观点对数据和信息建模，用于数据库设计。E-R 图中：
	- “方框”表示实体
	- “菱形”表示联系（1对1、1对多、多对多）
	- “椭圆”表示属性

- 基本数据模型，按照计算机的角度建立数据结构模型，常用的基本数据模型有层次模型、网状模型、面向对象模型和关系模型。我们主要关注关系模型，其实就是把 E-R 图转化为线性表（每个实体/关系转化出一个表）。

基本数据模型考虑3个方面：

- 数据结构（静态）
- 数据操作（动态）
- 数据的约束条件：
	- 实体完整性（主键的主属性不能取空值）
	- 参照完整性（外键要么是空值，要么必须存在于相应的表中）
	- 用户定义完整性（即相应属性的取值范围，例如性别仅取值男/女）


### 关系型数据库

- 关系：理解为一张二维表（就是表），每个关系有一个关系名（即表名）
- 元组：二维表中的一行（又称记录）
- 属性：二维表中的一列（又称字段）
- 域：属性的取值范围（又称取值限制）
- 关键字：一组可以唯一标识元组的属性（又称主键）
- 关系模式：指对关系的描述（又称表结构）

### 函数依赖
定义“x->y”：关系r中任意两个元组在“x”上的属性值相等，那么在“y”上的属性值也相等。称为“x函数确定y”或“y函数依赖于x”，“x”称为这个函数依赖的决定属性组/决定因素。（备注：实践中，依赖关系和具体场景中的一些强制设定有关）

基于上述定义，还可以做更细化的分类鉴别：

- 非平凡/平凡 函数依赖：若 x 不包含 y 则称为非平凡函数依赖（大多数都讨论这种依赖）
- 完全/部分 函数依赖：若 x 中所有属性联合才能确定 y 则称为完全函数依赖，例如“(学号+课程)->成绩”；否则为部分函数依赖，例如“(学号+课程)->学院”
- 传递依赖：由“x->y”和“y->z”确定“x->z”则称为传递依赖，例如“学号->学院->院长”

关于 超键/主键/候选键：
都是“在关系中能够唯一决定某元组的一组属性”

- 超键：包含冗余属性，例如关系“学号、性别、年龄”，则“(学号、性别)”、“(学号、性别、年龄)”都是超键
- 主键：不包含冗余属性
- 候选键：有资格做主键，但主键只选一个

其他补充概念：
- 外键：其他关系模式的主键
- 主属性/非主属性：属性被包含在主键中则称为主属性，否则称为非主属性
- 全码：如果一个关系模式只有一个包含了全部属性的主键，则该关系模式称为全码

#### Armstrong公理
设关系式 R(U, F)，其中 U 是关系模式 R 的属性集，F 是 U 上的一组函数依赖；则有3条推理规则：

- A1自反律：若 x⊆y⊆U，则 x->y
- A2增广率：若 x->y 且 z⊆U，则 xz->yz
- A3传递率：若 x->y 且 y->z，则 x->z

- 合并规则：若 x->y 且 x->z，则 x->yz
- 伪传递规则：若 x->y 且 wy->z，则 xw->z
- 分解规则：若 x->y 且 z⊆y，则 x->z


### 关系代数

集合运算符如下：

- ⋃ 并：两个关系的元组取并集（会去重）
- - 差：两个关系的元组取差集
- ⋂ 交：两个关系的元组取交集
- × 笛卡尔积：两个关系做笛卡尔积完全展开；两个关系列数分别为m、n，则笛卡尔积结果列数(m+n)，注意参与计算中左侧关系的所有列都放在结果中的左侧；另外两个关系元组行数分别为a、b，则笛卡尔积结果行数(m*n)
- σ 选择：选择关系中符合条件的行
- π 投影：选择关系中符合条件的列
- ∞ 连接（在 笛卡尔积 结果之上）
	- 等值连接：取相关列值相等的元组
	- 自然连接：特殊的等值连接，要求结果中去除重复列
- 外连接（在 笛卡尔积+自然连接 基础上，结果中依然删除重复列）
	- 左外连接：左表匹配失败的行也加入结果，即 Left Join
	- 右外连接：右表匹配失败的行也加入结果，即 Right Join
	- 完全外连接：所有匹配失败的行也加入结果，即 Full Outer Join

备注：实际计算中，“σ 1>4” 表示选择（where）第1列值大于第4列值的记录，而“σ 1>'4'”表示选择第1列值大于整数4的记录；另外 σ 条件中还可以包含 ∧（逻辑且）、∨（逻辑或）





